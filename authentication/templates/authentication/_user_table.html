<table class="table table-hover align-middle mb-0">
  <thead>
    <tr><th>Nom</th><th>Email</th><th>Rôle</th><th>Dernière connexion</th><th>Actions</th></tr>
  </thead>
  <tbody>
    {% for u in users %}
      <tr>
        <td>{{ u.username }}</td>
        <td>{{ u.email }}</td>
        <td>
          {% if u.role == 'admin' %}
            <span class="badge bg-danger">Admin</span>
          {% else %}
            <span class="badge bg-secondary">Utilisateur</span>
          {% endif %}
        </td>
        <td>{{ u.last_login|date:"Y-m-d H:i" }}</td>
        <td>
          <form method="POST" action="{% url 'block_user' u.id %}" style="display:inline;">{% csrf_token %}
            <button class="btn btn-sm {% if u.is_active %}btn-outline-warning{% else %}btn-warning{% endif %}">
              {% if u.is_active %}Bloquer{% else %}Débloquer{% endif %}
            </button>
          </form>
          <form method="POST" action="{% url 'change_role' u.id %}" style="display:inline;">{% csrf_token %}
            <button class="btn btn-sm btn-outline-info">Changer rôle</button>
          </form>
          <form method="POST" action="{% url 'delete_user' u.id %}" style="display:inline;"
                onsubmit="return confirm('Supprimer définitivement cet utilisateur ?')">
            {% csrf_token %}
            <button class="btn btn-sm btn-outline-danger">Supprimer</button>
          </form>
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="5" class="text-center text-muted">Aucun utilisateur</td></tr>
    {% endfor %}
  </tbody>
</table>
